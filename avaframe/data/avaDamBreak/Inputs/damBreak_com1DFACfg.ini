### Config File - This file contains the main settings for the simulation run for the dam break problem
## This file is part of Avaframe.


[GENERAL]
#++++++++++++++++ Simulation type
# list of simulations that shall be performed (null, ent, res, entres, available (use all available input data))
simTypeList = null

#+++++++++++++ Output++++++++++++
# desired result Parameters (ppr, pfd, pfv, FD, FV, P, particles) - separated by |
resType = FD|FV|Vx|Vy|Vz
# saving time step, i.e.  time in seconds (first and last time step are always saved)
# option 1: give an interval with start:interval in seconds (tStep = 0:5 - this will save desired results every 5 seconds for the full simulation)
# option 2: explicitly list all desired time steps (closest to actual computational time step) separated by | (example tSteps = 1|50.2|100)
# NOTE: initial and last time step are always saved!
tSteps = 0:1

#++++++++++++++++ particle Initialisation +++++++++
# initial particle distribution, options: random, semirandom, uniform
# semirandom: particles are uniformly distributed with a little random variation
initPartDistType = random
# if true use file (import particles initial distribution from file)
initialiseParticlesFromFile = False
particleFile =
# seed for random generator
seed = 12345
# particle initialisation step - set iniStep to True to activate redistribution of particles to reduce SPH force
# this is in a development stage - hence parameters are set for development and will be adjusted after extensive testing
iniStep = True|False
# artificial viscosity for initialisation parameter
subgridMixingFactorIni = 10.
# time step for initialisation
dtIni = 0.05
# sphOption for ini
sphOptionIni = 2
# stop criterion value for initialisation
stopCritIni = 0.1
# stop criterion value for initialisation if SPHforce < 1 from the outset;  ratio from oldValue to currentValue
stopCritIniSmall = 1.001
# max number of iterations - high number might cause significant increase in computational time
maxIterations = 50
# buffer zone factor multiplied with sphKernelRadius
bufferZoneFactor = 4
# in addition to the actual release line initialize additionallyFixedFactor*sphKernelRadius*bufferZoneFactor
# as particles that are not fixed - so that fixed boundaries do not affect the interior of the release particles
additionallyFixedFactor = 0.275
# Resetting the mass when relThField is provided: 1) fdOptionIni = False; using the mass of each cell
# and the particles within the cell (mPart = massCell/nPartPerCell) 2) fdOptionIni = True; by first computing the particles'
# flow thickness (interpolation of the relThField) and then particles' mass is computed using the particles' area
# (areaParticle = areaCell /number of particles per cell)
fdOptionIni = False

#+++++++++SNOW properties
# True if release thickness should be read from shapefile file; if False - relTh read from ini file
relThFromShp = False
relTh = 1

#++++++++++++Time stepping parameters
# fixed time step [s] (also used as first time step when using CFL)
dt = 0.1
# End time [s]
tEnd = 20
# only one of the two following options can be activated
# to use a variable time step (defined by the CFL number)
cflTimeStepping = False
# to use a variable time step (time step depends on kernel radius)
sphKernelRadiusTimeStepping = True
# courant number if option cflTimeStepping is chosen.
# Upper time step limit coefficient if option sphKernelRadiusTimeStepping is chosen.
cMax = 0.01
# to constrain the lower margin of the allowed time step
constrainCFL = False
# max time step in case of small velocities
maxdT = 0.05
# min time step in case of high velocity
mindT = 0.001
# stopCriterion (based on massFlowing or kinEnergy)
stopCritType = massFlowing
# if based on massFlowing, specify the velocity threshold for flowing mass (m/s)
uFlowingThreshold = 0.0
# stopCriterion (stops when massFlowing<0.01*peakMassFlowing or ke<0.01*pke)
stopCrit = 0.0

#+++++++++++++SPH parameters
# SPH gradient option
# 0) No pressure gradients computed
# 1) SamosAT style (no reprojecion on the surface, dz = 0 and gz is used)
# 2) SamosAT done in the cartesian coord system (reprojecion on the surface, dz != 0 and g3 is used)
# 3) SamosAT but done in the local coord system (will hopefully allow us to add the earth pressure coef)
# and this time reprojecion on the surface, dz not 0 and g3 is used
sphOption = 1
# Choice of artificial viscosity
# 0) No artificial viscosity
# 1) SAMOS artificial viscosity
# 2) Ata artificial viscosity
viscOption = 0

#++++++++++++++++ Particles
# number of particles defined by: MPPDIR= mass per particle direct, MPPDH= mass per particles through release thickness,
# MPPKR= mass per particles through number of particles per kernel radius
massPerParticleDeterminationMethod = MPPKR
# is computed with: nPPK = nPPK0 * (sphKR/sphKR0)^aPPK
# where sphKR is the sphKernelRadius specified further up
# reference kernel radius
sphKR0 = 5
# reference number of particles per kernel radius
nPPK0 = 10
# variation of nppK exponent
aPPK = -1.5
# splitting option
# either split particles based on mass (splitOption = 0)
# or split/merge in order to keep a constant number of particles per kernel radius(splitOption = 1)
splitOption = 0

# if splitOption=0
# threshold for splitting particles, split if: mPart > massPerPart x thresholdMassSplit
thresholdMassSplit = 10


# remesh the input DEM
# expected mesh size [m]
meshCellSize = 2
# sph kernel smoothing length [m]
sphKernelRadius = 2

#+++++++++++++Flow model parameters+++++++++
# subgridMixingFactor
subgridMixingFactor = 10.
# curvature acceleration coefficient
# take curvature term into account in the gravity acceleration term
# 0 if deactivated, 1 if activated
curvAcceleration = 1

#++++++++++++Friction model
# add the friction using an explicit formulation (1)
# 0 use an implicit method
explicitFriction = 1
# friction type (samosAT, Coulomb)
frictModel = Coulomb
#+++++++++++++SamosAt friction model
mu = 0.3838640350354158


[DAMBREAK]
# set time step of analysis
tSave = 10
# slope angle [°]
phi = 24
# bed friction angle [°]
delta = 21
u0 = 0.
# domain extend for error computation
xStart = -200
xEnd = 200
yStart = -50
yEnd = 50


# ploting flags
plotIntermediate = True
relativError = True
