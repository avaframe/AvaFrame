
digraph "sphinx-ext-graphviz" {
compound=true;
  size="12,20";
  rankdir="TB";
  graph [ranksep=1, splines=ortho, fontname="Verdana", fontsize="18"];
  node [shape=box style=filled fontsize=12 fontname="Verdana" fillcolor="#efefef"];
  edge [fontname="Sans", fontsize="9"];

  prepareMesh [label="Read and prepare mesh",
    href="DFAnumerics.html#mesh-and-interpolation"];
  initializeParticles [label="Initialize particles",
    href=""];
  initializeFields [label="Initialize entrainment, \n resistance fields",
    href="modelCom1DFA.html"];
  timeLoop [label="Time iterations"];
  endTimeLoop [width=0 shape=point label=""];
  artifViscosity [label="Add artificial viscosity",
    href="DFAnumerics.html#artificial-viscosity"];
  coputeFrictForce [label="Compute friction forces",
    href="theoryCom1DFA.html#friction-model"];
  computeResForce [label="Compute resistance forces"];
  updateMassEntr [label="Update mass due to entrainment"];
  updateVelocityEntr [label="Update velocity due to \nentrainmened mass"];
  updateVelocityDrive [label="Update velocity with \n dirving force component"];
  updateVelocityFrict [label="Update velocity with \n friction component"];
  updateFields [label="Update fields"];
  updateParticlesFlowDepth [label="Update particles flow depth"];


  subgraph cluster_0 {
    style=filled;
    color=lightgrey;
    prepareMesh -> initializeParticles [weight=1];
    initializeParticles -> initializeFields [weight=1];
    label = "Initializazion";
  }

  subgraph cluster_1 {
    style=filled;
    color=lightgrey;
    artifViscosity -> coputeFrictForce [weight=10];
    coputeFrictForce -> computeResForce [weight=10];
    computeResForce -> updateMassEntr [weight=10];
    updateMassEntr -> updateVelocityEntr [weight=10];
    label = "Compute Forces";
  }

  subgraph cluster_2 {
    updateVelocityDrive -> updateVelocityFrict [weight=10];
    label = "Update position";
    style=filled;
    color=lightgrey;
  }
  subgraph cluster_3 {
    updateFields -> updateParticlesFlowDepth [weight=1];
    label = "Update Fields";
    style=filled;
    color=lightgrey;
  }

  start -> prepareMesh [lhead=cluster_0];
  initializeFields -> timeLoop [weight=10,ltail=cluster_0];
  timeLoop -> artifViscosity [weight=10,lhead=cluster_1];
  updateVelocityEntr -> updateVelocityDrive [weight=10,ltail=cluster_1,lhead=cluster_2];
  updateVelocityFrict -> updateFields [weight=10,ltail=cluster_2,lhead=cluster_3];
  updateParticlesFlowDepth -> endTimeLoop [weight=10,ltail=cluster_3, arrowhead=none];
  endTimeLoop -> end [weight=10];
  endTimeLoop -> timeLoop [weight=1, constraint=false];

  start [shape=Mdiamond];
  end [shape=Msquare];
   }
